name: tagged release

on:
  push:
    tags:
      - "*"
jobs:
  tagged-release:
    name: "Tagged Release"
    runs-on: "ubuntu-latest"

    steps:
      - name: "Build & test"
        run: |
          echo "done!"
      - name: "Check if tag event"
        id: tag_check
        run: |
          if [ -n "$GITHUB_REF" ]; then
            if [[ "$GITHUB_REF" == "refs/tags/"* ]]; then
              echo "Tag event detected"
              echo "::set-output name=is_tag_event::true"
            else
              echo "Not a tag event"
              echo "::set-output name=is_tag_event::false"
            fi
          else
            echo "No GITHUB_REF found"
            echo "::set-output name=is_tag_event::false"
          fi
      - name: "Automatic Release"
        if: ${{ steps.tag_check.outputs.is_tag_event == 'true' }}
        uses: "marvinpinto/action-automatic-releases@latest"
        with:
          repo_token: ${{ secrets.JENKINS }}
          automatic_release_tag: "latest"
          prerelease: false
